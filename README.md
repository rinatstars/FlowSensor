# FlowSensor

**FlowSensor** ‚Äî —ç—Ç–æ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–æ–∑–¥—É—à–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–∞ —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–æ–∫–æ–ª TCP. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä—É —É–¥–æ–±–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ —Ç–µ–∫—É—â–∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

---

## üì¶ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –∑–∞—Å–ª–æ–Ω–∫–∏ (—É—Å—Ç–∞–Ω–æ–≤–∫–∞, –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ, —Å—Ä–µ–¥–Ω–µ–µ –ø–æ–ª–æ–∂–µ–Ω–∏–µ)
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Å—á–∏—Ç—ã–≤–∞–Ω–∏–µ –¥–∞–≤–ª–µ–Ω–∏—è (–∏–ª–∏ —Å–∫–æ—Ä–æ—Å—Ç–∏, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞)
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –∏ —Ç–µ–∫—É—â–µ–≥–æ –¥–∞–≤–ª–µ–Ω–∏—è
- –ö–æ–Ω—Ç—Ä–æ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–Ω—ã–º —Ñ–ª–∞–≥–∞–º
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö –∫–æ–º–∞–Ω–¥ (–°–¢–ê–†–¢, –°–¢–û–ü, –°–û–•–†.FLASH, –û–¢–ö–†–´–¢–û, –ó–ê–ö–†–´–¢–û)
- –í–µ–¥–µ–Ω–∏–µ –ª–æ–≥–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π –≤ `.xlsx` —Ñ–∞–π–ª
- –ì–∏–±–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —á–µ—Ä–µ–∑ —Ñ–∞–π–ª `config.json`

---

## üñºÔ∏è –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å GUI

–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø–∞–Ω–µ–ª–µ–π:

- **–°—Ç–∞—Ç—É—Å** ‚Äî –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å—Ç–∞—Ç—É—Å–Ω—ã–µ —Ñ–ª–∞–≥–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—à–∏–±–∫–∏, –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å)
- **–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞** ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É
- **–ü–æ–∑–∏—Ü–∏—è –∑–∞—Å–ª–æ–Ω–∫–∏** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π/—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –ø–æ–∑–∏—Ü–∏–∏
- **–î–∞–≤–ª–µ–Ω–∏–µ/–°–∫–æ—Ä–æ—Å—Ç—å** ‚Äî –∏–∑–º–µ—Ä–µ–Ω–Ω—ã–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–∞–≤–ª–µ–Ω–∏—è (—Ä–µ–∂–∏–º —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º)
- **–ö–æ–º–∞–Ω–¥—ã** ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –ø–æ–ª–æ–∂–µ–Ω–∏–µ–º –∑–∞—Å–ª–æ–Ω–∫–∏
- **–õ–æ–≥** ‚Äî –∑–∞–ø—É—Å–∫/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, –∑–∞–ø–∏—Å—å —Å–µ—Ä–∏–∏ –∏–∑–º–µ—Ä–µ–Ω–∏–π

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É —É–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `config.json`:

```json
{
  "ip": "10.11.13.241",
  "port": 502,
  "device_id": 3,
  "max_attempts": 5,
  "poll_interval_sec": 2
}
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
FlowSensor/
‚îú‚îÄ‚îÄ config.json              # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ constants.py            # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —Ä–µ–≥–∏—Å—Ç—Ä—ã Modbus
‚îú‚îÄ‚îÄ crc.py                  # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è CRC16
‚îú‚îÄ‚îÄ device_controller.py    # –õ–æ–≥–∏–∫–∞ –æ–±–º–µ–Ω–∞ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º –ø–æ Modbus
‚îú‚îÄ‚îÄ gui.py                  # –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (Tkinter)
‚îú‚îÄ‚îÄ logger.py               # –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Excel
‚îú‚îÄ‚îÄ main.pyw                # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–±–µ–∑ –∫–æ–Ω—Å–æ–ª–∏)
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ logs/
    ‚îî‚îÄ‚îÄ device_data_log.xlsx # –õ–æ–≥ –∏–∑–º–µ—Ä–µ–Ω–∏–π (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç—Å—è)
```

---

## üöÄ –ó–∞–ø—É—Å–∫

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt
   ```

2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `config.json` —Å–æ–¥–µ—Ä–∂–∏—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ IP/–ø–æ—Ä—Ç/ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É:
   ```bash
   pythonw main.pyw
   ```

   *(–Ω–∞ Windows –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ –±–µ–∑ –∫–æ–Ω—Å–æ–ª–∏, –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `python main.pyw`)*

---

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª `logs/device_data_log.xlsx` —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) –≤ 60 —Å–µ–∫—É–Ω–¥. –î–∞–Ω–Ω—ã–µ –≤–∫–ª—é—á–∞—é—Ç:

- –ú–µ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏
- –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ (¬∞C)
- –î–∞–≤–ª–µ–Ω–∏–µ (–ü–∞)
- –ü–æ–∑–∏—Ü–∏—è –∑–∞—Å–ª–æ–Ω–∫–∏
- –°—Ç–∞—Ç—É—Å (–±–∏—Ç–æ–≤–∞—è –º–∞—Å–∫–∞)

–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ –≤—Ä—É—á–Ω—É—é –∏–∑ GUI: **–°–¢–ê–†–¢ / –°–¢–û–ü**, –ª–∏–±–æ –∫–æ–º–∞–Ω–¥–æ–π –∑–∞–ø–∏—Å–∏ 20 –∏–∑–º–µ—Ä–µ–Ω–∏–π.

---

## üß± –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–°–º. `requirements.txt`. –û—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- `tkinter` ‚Äî –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- `openpyxl`, `pandas` ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Excel
- `matplotlib` ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- `numpy` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–∏—Å–µ–ª –∏ –º–∞—Å—Å–∏–≤–æ–≤

---

## üìå –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Å—Ç–µ–Ω–¥–æ–≤—ã—Ö –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –∏—Å–ø—ã—Ç–∞–Ω–∏–π –ø—Ä–æ—Ç–æ—Ç–∏–ø–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å —Å –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–º TCP.
- –í–µ–¥–µ–Ω–∏–µ –ª–æ–≥–∞ —É—Å—Ç–æ–π—á–∏–≤–æ –∫ –æ—à–∏–±–∫–∞–º –∑–∞–ø–∏—Å–∏, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ—Ç–µ—Ä—å.
